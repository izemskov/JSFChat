<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Image Test</title>
</h:head>
<h:body>
    <table cellpadding="0" cellspacing="0" border="0" width="100%">
    <tbody>
    <tr>
        <td width="1024" valign="top">
            <p:scrollPanel mode="native" id="mainContainer" style="width: 400px; height: 400px;">
                <h:form>
                    <h:panelGroup layout="block" style="width: 1024px; height: 768px; background-image: url('#{request.contextPath}/resources/images/bg1.png'); background-repeat: no-repeat;">

                    <a4j:poll id="poll" interval="100" enabled="#{true}" actionListener="#{gameBean.updatePerson()}" render="poll,grid,otherGrid"/>

                    <h:panelGroup layout="block"
                                  id="grid"
                                  style="width: #{gameBean.person.width}px; height: #{gameBean.person.height}px;
                                         text-align:center;
                                         position: absolute;
                                         top: #{gameBean.person.getTopPosition()}px; left: #{gameBean.person.getLeftPosition()}px;">
                        <p:outputLabel style="font-size: 11px; font-weight: bold; color: gold;" value="#{gameBean.person.name}"/>
                        <p:graphicImage id="sprite" name="#{gameBean.person.image}"/>
                    </h:panelGroup>

                    <h:panelGroup layout="block" id="otherGrid">
                        <ui:repeat value="#{gameBean.otherPersons}" var="otherPerson">
                            <h:panelGroup layout="block"
                                          id="grid#{otherPerson.uuid}"
                                          style="width: #{gameBean.person.width}px; height: #{gameBean.person.height}px;
                                                 text-align:center;
                                                 position: absolute;
                                                 top: #{otherPerson.getTopPosition()}px; left: #{otherPerson.getLeftPosition()}px;">
                                <p:outputLabel style="font-size: 11px; color: gold;" value="#{otherPerson.name}"/>
                                <p:graphicImage id="sprite#{otherPerson.uuid}" name="#{otherPerson.image}"/>
                            </h:panelGroup>
                        </ui:repeat>
                    </h:panelGroup>

                    </h:panelGroup>
                </h:form>
            </p:scrollPanel>
        </td>
        <td width="220">
            <p:scrollPanel layout="block">
                <h:form>
                    <a4j:poll id="poll2" interval="2000" enabled="#{true}" render="poll2,chatMessagesBlock"/>

                    <h:panelGroup layout="block" id="chatMessagesBlock">
                        <ui:repeat value="#{gameBean.chatMessages}" var="chatMessage">
                            <p:fieldset width="220" legend="#{chatMessage.header}" style="margin-bottom: 10px;">
                                <p class="m-0" style=" font-size: 10px;">
                                    #{chatMessage.message}
                                </p>
                            </p:fieldset>
                        </ui:repeat>
                    </h:panelGroup>

                    <h:panelGroup layout="block" rendered="#{false}">
                        <table cellpadding="0" cellspacing="0" border="0">
                            <tbody>
                            <tr>
                                <td>
                                    <p:inputText id="textMessage" value="#{gameBean.chatMessage}"/>
                                </td>
                                <td style="padding-left: 5px;">
                                    <p:commandButton actionListener="#{gameBean.sendChatMessage()}" icon="pi pi-send" />
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </h:panelGroup>
                </h:form>
            </p:scrollPanel>
        </td>
    </tr>
    </tbody>
    </table>
</h:body>
</html>
